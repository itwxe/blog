---
title: Linux安装MinIO
tags:
  - Linux
  - MinIO
permalink: '/dev-ops/software-installation/linux/b3a24516.html'
date: 2019-11-02 00:00:00
---

# Linux安装MinIO

> 作者：IT王小二
>
> 博客：[https://itwxe.com](https://itwxe.com)

记录一下自己在 Linux 下安装 MinIO 过程，用于对象存储。

## 一、准备工作

> 安装过程参考至 [MinIO官网](https://docs.min.io/cn/minio-quickstart-guide.html)

### 下载MinIO

从 [MinIO官网](https://docs.min.io/cn/minio-quickstart-guide.html) 下载安装二进制文件上传 CentOS，或者在 CentOS 使用 wget 命令下载。

### 开放访问端口

我使用的默认端口 9000。

```bash
# 查看想开的端口是否已开, 若此提示FirewallD is not running, 表示为不可知的防火墙 需要查看状态并开启防火墙, 如果是云服务器还需要去控制台配置安全组访问
firewall-cmd --query-port=9000/tcp

# 开启端口, success代表成功
firewall-cmd --add-port=9000/tcp --permanent
# 刷新配置, 使配置生效
firewall-cmd --reload
```

### 创建用户及用户组

```bash
# 创建用户组
groupadd minio

# 创建用户
useradd -r -g minio minio

# 查看创建好的用户组
id minio
```

## 二、安装MinIO

### 创建目录, 赋予权限

```bash
# 创建多个文件夹
mkdir -p /usr/local/minio/{bin,etc,data}

# 将安装文件上传至/usr/local/minio/bin目录下, 赋予文件可执行权限
chmod +x minio

# 配置minio目录所属的用户和组
chown minio:minio /usr/local/minio -R
```

**注：**
bin：用来放下载好的minio二进制文件。
etc：用来放minio配置文件。
data：用来放数据。

### 编辑MinIO配置文件

```bash
# 进入目录
cd /usr/local/minio/etc

# 新建配置文件minio
vim minio

# 添加内容
MINIO_VOLUMES="/usr/local/minio/data/"
MINIO_OPTS="--address 0.0.0.0:9000"
MINIO_ACCESS_KEY=minioAdmin
MINIO_SECRET_KEY=12345678
```

**注：**
MINIO_VOLUMES：使用的存储卷，minio要有存储卷的读写权限。
MINIO_OPTS：使用的可以访问的 ip 和使用端口, 0.0.0.0 代表所有 ip，9000为默认端口。
MINIO_ACCESS_KEY：登录用户名，最少5个字符。
MINIO_SECRET_KEY：登录密码，最少8个字符。

### 配置MinIO服务开机自启

下载开机启动配置文件。

```bash
wget https://raw.githubusercontent.com/minio/minio-service/master/linux-systemd/minio.service
```

修改开机启动配置文件：命令：`vim minio.service`

AssertFileIsExecutable：修改为自定义二进制文件位置。
WorkingDirectory：修改为自定义 minio 工作目录。
User：修改为自定义用户。
Group：修改为自定义用户组。
EnvironmentFile：修改为自定义配置文件位置。
ExecStartPre：执行开始之前检查, 如果再配置文件中${MINIO_VOLUMES}不存在则退出。
ExecStart：执行启动命令。

```
[Unit]
Description=MinIO
Documentation=https://docs.min.io
Wants=network-online.target
After=network-online.target
AssertFileIsExecutable=/usr/local/minio/bin/minio

[Service]
WorkingDirectory=/usr/local/minio/

User=minio
Group=minio

EnvironmentFile=/usr/local/minio/etc/minio
ExecStartPre=/bin/bash -c "if [ -z \"${MINIO_VOLUMES}\" ]; then echo \"Variable MINIO_VOLUMES not set in /usr/local/minio/etc/minio\"; exit 1; fi"

ExecStart=/usr/local/minio/bin/minio server $MINIO_OPTS $MINIO_VOLUMES

# Let systemd restart this service always
Restart=always

# Specifies the maximum file descriptor number that can be opened by this process
LimitNOFILE=65536

# Disable timeout logic and wait until process is stopped
TimeoutStopSec=infinity
SendSIGKILL=no

[Install]
WantedBy=multi-user.target

# Built for ${project.name}-${project.version} (${project.name})
```

移动开机启动配置文件。

```bash
mv minio.service /lib/systemd/system/minio.service
```

使用 `systemctl enable minio.service` 开机自启, 重启 CentOS 查看效果。

```bash
# 启动minio服务
systemctl start minio.service

# 停止minio服务
systemctl stop minio.service

# 重启minio服务
systemctl restart minio.service

# 查看minio服务当前状态
systemctl status minio.service

# 设置minio服务开机自启动
systemctl enable minio.service

# 停止minio服务开机自启动
systemctl disable minio.service
```

